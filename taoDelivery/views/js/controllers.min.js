define("taoDelivery/controller/routes",[],function(){return{Delivery:{deps:"controller/deliveryAssembly",actions:{getSectionActions:"controller/main/actions",getSectionTrees:"controller/main/trees",excludeTesttaker:"controller/testtaker"}},Compilation:{actions:{index:"controller/compilation/compiling"}}}}),define("taoDelivery/controller/compilation/compiling",["module","jquery","i18n","context","helpers","uiBootstrap"],function(e,t,i,o,n){function r(e,i){t("#initCompilation").hide(),t("#generatingProcess_info").show(),t("#generatingProcess_feedback").empty().hide(),t("#progressbar").empty(),t(".main-container").append('<div id="compilationReport"></div>'),t.ajax({url:n._url("compile","Compilation","taoDelivery"),type:"POST",dataType:"text",data:{uri:e,classUri:i},success:function(e){t("#generatingProcess_info").hide(),t("#compilationReport").html(e)},error:function(e,t,i){a(i)}})}function a(e,n){t("<img/>").attr("src",o.root_url+"taoDelivery/views/img/"+n).appendTo(t("#progressbar")),t("#progressbar").append(e),t("#postCompilation").show(),t("#initCompilation").html(i("Recompile the delivery"))}return{start:function(){var i=e.config();t("#generatingProcess_info").hide(),t(".back").click(function(e){e.preventDefault(),n._load(n.getMainContainerSelector(),o.root_url+"taoDelivery/Delivery/editDelivery/",{uri:i.uri,classUri:i.classUri})}),t("#compiler").click(function(e){e.preventDefault(),r(i.uri,i.classUri)})}}}),define("taoDelivery/controller/deliveryAssembly",["jquery","i18n","helpers","uiBootstrap","module"],function(e,t,i,o,n){var r=o.tabs,a=i.getTabIndexByName("manage_delivery_templates");return{start:function(){var t=n.config();r.each(function(t){t===a&&e(this).css({border:"3px"})}),"authoring"!==t.action,t.reload&&o.initTrees(),t.message&&i.createMessage(t.message),e("#saver-status").click(function(){var t=e('input[name="status"]:checked').val(),n=e('input[name="assemblyUri"]').val();e.ajax({url:i._url("setStatus","Delivery","taoDelivery"),type:"POST",dataType:"text",data:{uri:n,status:t},success:function(){i.createMessage("Status saved"),o.initTrees()},error:function(e,t,i){console.log("Error occured: "+i)}})})}}}),function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define("spin",t):e.Spinner=t()}(this,function(){function e(e,t){var i,o=document.createElement(e||"div");for(i in t)o[i]=t[i];return o}function t(e){for(var t=1,i=arguments.length;i>t;t++)e.appendChild(arguments[t]);return e}function i(e,t,i,o){var n=["opacity",t,~~(100*e),i,o].join("-"),r=.01+i/o*100,a=Math.max(1-(1-e)/t*(100-r),e),s=u.substring(0,u.indexOf("Animation")).toLowerCase(),l=s&&"-"+s+"-"||"";return f[n]||(p.insertRule("@"+l+"keyframes "+n+"{0%{opacity:"+a+"}"+r+"%{opacity:"+e+"}"+(r+.01)+"%{opacity:1}"+(r+t)%100+"%{opacity:"+e+"}100%{opacity:"+a+"}}",p.cssRules.length),f[n]=1),n}function o(e,t){var i,o,n=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),o=0;o<d.length;o++)if(i=d[o]+t,void 0!==n[i])return i;return void 0!==n[t]?t:void 0}function n(e,t){for(var i in t)e.style[o(e,i)||i]=t[i];return e}function r(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)void 0===e[o]&&(e[o]=i[o])}return e}function a(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function s(e,t){return"string"==typeof e?e:e[t%e.length]}function l(e){return"undefined"==typeof this?new l(e):void(this.opts=r(e||{},l.defaults,h))}function c(){function i(t,i){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',i)}p.addRule(".spin-vml","behavior:url(#default#VML)"),l.prototype.lines=function(e,o){function r(){return n(i("group",{coordsize:u+" "+u,coordorigin:-c+" "+-c}),{width:u,height:u})}function a(e,a,l){t(f,t(n(r(),{rotation:360/o.lines*e+"deg",left:~~a}),t(n(i("roundrect",{arcsize:o.corners}),{width:c,height:o.width,left:o.radius,top:-o.width>>1,filter:l}),i("fill",{color:s(o.color,e),opacity:o.opacity}),i("stroke",{opacity:0}))))}var l,c=o.length+o.width,u=2*c,d=2*-(o.width+o.length)+"px",f=n(r(),{position:"absolute",top:d,left:d});if(o.shadow)for(l=1;l<=o.lines;l++)a(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=o.lines;l++)a(l);return t(e,f)},l.prototype.opacity=function(e,t,i,o){var n=e.firstChild;o=o.shadow&&o.lines||0,n&&t+o<n.childNodes.length&&(n=n.childNodes[t+o],n=n&&n.firstChild,n=n&&n.firstChild,n&&(n.opacity=i))}}var u,d=["webkit","Moz","ms","O"],f={},p=function(){var i=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],i),i.sheet||i.styleSheet}(),h={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};l.defaults={},r(l.prototype,{spin:function(t){this.stop();var i,o,r=this,s=r.opts,l=r.el=n(e(0,{className:s.className}),{position:s.position,width:0,zIndex:s.zIndex}),c=s.radius+s.length+s.width;if(t&&(t.insertBefore(l,t.firstChild||null),o=a(t),i=a(l),n(l,{left:("auto"==s.left?o.x-i.x+(t.offsetWidth>>1):parseInt(s.left,10)+c)+"px",top:("auto"==s.top?o.y-i.y+(t.offsetHeight>>1):parseInt(s.top,10)+c)+"px"})),l.setAttribute("role","progressbar"),r.lines(l,r.opts),!u){var d,f=0,p=(s.lines-1)*(1-s.direction)/2,h=s.fps,v=h/s.speed,m=(1-s.opacity)/(v*s.trail/100),y=v/s.lines;!function g(){f++;for(var e=0;e<s.lines;e++)d=Math.max(1-(f+(s.lines-e)*y)%v*m,s.opacity),r.opacity(l,e*s.direction+p,d,s);r.timeout=r.el&&setTimeout(g,~~(1e3/h))}()}return r},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(o,r){function a(t,i){return n(e(),{position:"absolute",width:r.length+r.width+"px",height:r.width+"px",background:t,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/r.lines*c+r.rotate)+"deg) translate("+r.radius+"px,0)",borderRadius:(r.corners*r.width>>1)+"px"})}for(var l,c=0,d=(r.lines-1)*(1-r.direction)/2;c<r.lines;c++)l=n(e(),{position:"absolute",top:1+~(r.width/2)+"px",transform:r.hwaccel?"translate3d(0,0,0)":"",opacity:r.opacity,animation:u&&i(r.opacity,r.trail,d+c*r.direction,r.lines)+" "+1/r.speed+"s linear infinite"}),r.shadow&&t(l,n(a("#000","0 0 4px #000"),{top:"2px"})),t(o,t(l,a(s(r.color,c),"0 0 1px rgba(0,0,0,.1)")));return o},opacity:function(e,t,i){t<e.childNodes.length&&(e.childNodes[t].style.opacity=i)}});var v=n(e("group"),{behavior:"url(#default#VML)"});return!o(v,"transform")&&v.adj?c():u=o(v,"animation"),l}),define("taoDelivery/controller/runtime/deliveryExecution",["jquery","iframeResizer","spin"],function(e,t,i){function o(t){0===e("#overlay").length&&(e('<div id="overlay"></div>').appendTo(document.body),e('<div id="loading"><div></div></div>').appendTo(document.body));var o={lines:11,length:21,width:8,radius:36,corners:1,rotate:0,direction:t===!0?-1:1,color:"#888",speed:1.5,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9};new i(o).spin(e("#loading > div").get(0))}function n(){setTimeout(function(){e("#loading").fadeOut(300,function(){e(this).remove(),e("#overlay").remove()})},300)}function r(){var t=e("#iframeDeliveryExec"),i=e(window).height(),o=0,n=e("#control");1===n.length&&(o=n.outerHeight(!0));var r=i-o;(navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?0:1)||(r-=20),t.css("height",r+"px")}return{start:function(t){var i=e("#iframeDeliveryExec");e("#tools").css("height","auto");var a=t.serviceApi;a.onFinish(function(){e.ajax({url:t.finishDeliveryExecution,data:{deliveryExecution:t.deliveryExecution},type:"post",dataType:"json",success:function(e){window.location=e.destination}})}),e(document).on("loading",function(e,t){o(t)}).on("unloading",function(){n()}).on("shutdown-com",function(){e(document).off("heightchange"),i.off("load.eventHeight").off("load.cors")}),a.loadInto(i.get(0)),e(window).bind("resize",function(){r()}),r()}}}),function(){var e=document.getElementById("amd-loader").getAttribute("data-config");require([e],function(){require(["jquery"],function(e){e("ul li").mouseover(function(){e("a .actionsBox .button",this).addClass("buttonSelected")}),e("ul li").mouseleave(function(){e("a .actionsBox .button",this).removeClass("buttonSelected")})})})}(),define("taoDelivery/controller/runtime/index",function(){}),define("taoDelivery/controller/testtaker",["jquery","i18n","helpers","uiBootstrap","module"],function(e,t,i){function o(){var t=e(this).parent().attr("id");if("excludedList"==t)var i=e("#assignedList");else if("assignedList"==t)var i=e("#excludedList");"undefined"!=typeof i&&(i.append(this),this.scrollIntoView())}var n,r=e("#tt-filter"),a=e("#assignedList"),s=function(){var e=r.val();clearTimeout(n),n=setTimeout(function(){l(new RegExp(e),a)},300)},l=function(t,i){i.children().each(function(i,o){null==e(o).text().match(t)?e(o).hide():e(o).show()})};return{start:function(){e("#save-tt").click(function(){var o=[];e("#excludedList > li").each(function(){o.push(e(this).data("uri"))});var n=e('input[name="assemblyUri"]').val();e.ajax({url:i._url("saveExcluded","Delivery","taoDelivery"),type:"POST",data:{uri:n,excluded:JSON.stringify(o)},dataType:"json",success:function(e){e.saved&&(i.createInfoMessage(t("Selection saved successfully")),i._load(i.getMainContainerSelector(),i._url("editDelivery","Delivery","taoDelivery"),{uri:n}))},complete:function(){i.loaded()}})}),e("#assignedList > li").click(o),e("#excludedList > li").click(o),e("#close-tt").click(function(){e("#testtaker-form").modal("close")}),r.keyup(s).siblings(".ctrl").click(s)}}});